<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Google Sheets API テスト</title>
<script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
<h1>Google Sheets API テスト</h1>
<button id="authorize-btn">スプレッドシート読み込み</button>

<script>
const CLIENT_ID = '356906835635-q2le5c9jjcugnvsbn7mmghpoh2g2f3cq.apps.googleusercontent.com';
const SPREADSHEET_ID = '1N9mC-I7DVubvXPKxyu0yR2M2u2re743u-u8IPAVMwso';
const RANGE = 'iPhone17-overseas-prices!A1:AE19'; // 読みたい範囲

function initClient() {
    gapi.client.init({
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        clientId: CLIENT_ID,
        scope: "https://www.googleapis.com/auth/spreadsheets.readonly"
    }).then(() => {
        console.log('GAPI client initialized');
        document.getElementById('authorize-btn').addEventListener('click', () => {
            const authInstance = gapi.auth2.getAuthInstance();
            authInstance.signIn().then(loadSheet).catch(err => console.error(err));
        });
    });
}

function loadSheet() {
    gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SPREADSHEET_ID,
        range: RANGE
    }).then(response => {
        console.log('取得データ:', response.result.values);
        alert('コンソールにデータを出力しました');
    }).catch(err => {
        console.error('取得失敗', err);
    });
}

// gapiを読み込んだら初期化
gapi.load('client:auth2', initClient);
</script>
</body>
</html>
