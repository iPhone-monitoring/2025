<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Google Sheets API テスト</title>
<script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
<h1>Google Sheets API テスト</h1>
<button id="authorize-btn">スプレッドシート読み込み</button>

<script>
const CLIENT_ID = 'YOUR_CLIENT_ID.apps.googleusercontent.com'; // ここを置き換え
const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID';                  // ここを置き換え
const RANGE = 'Sheet1!A1:C10';                                 // 読みたい範囲

function initClient() {
    gapi.client.init({
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        clientId: CLIENT_ID,
        scope: "https://www.googleapis.com/auth/spreadsheets.readonly"
    }).then(() => {
        document.getElementById('authorize-btn').addEventListener('click', () => {
            gapi.auth2.getAuthInstance().signIn().then(loadSheet);
        });
    });
}

function loadSheet() {
    gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SPREADSHEET_ID,
        range: RANGE
    }).then(response => {
        console.log('取得データ:', response.result.values);
        alert('データをコンソールに表示しました');
    }, err => {
        console.error('取得失敗', err);
    });
}

gapi.load('client:auth2', initClient);
</script>
</body>
</html>
